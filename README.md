# 不要なアイテムを削除 ReadMe

ドキュメント中の不要なオブジェクトを削除するIllustrator用スクリプトです。孤立点、空のポイント文字、空のエリア内文字、空のパス上文字、ヘアラインパス、不透明度0％のオブジェクトを検出できます。

<div class="fig center" style="margin-bottom: 20px;"><img src="https://www.graphicartsunit.com/saucer/images/remove_needless_items/cover.png" alt="イメージ" class="noshadow"></div>

-----

### 更新履歴

* **0.8.1：スクリプト名の変更忘れを修正**
* 0.8.0：コードをリファクタリング／設定値の保存に対応／スクリプト名変更
* 0.7.4：不透明度0％のオブジェクトに対応
* 0.7.3：へアラインパスの検出を改善
* 0.7.2：へアラインパスの検出を改善
* 0.7.1：シンボルオブジェクトが存在するときに不要なアラートが表示されるのを改善
* 0.7.0：ロック、非表示オブジェクトの削除機能追加／ヘアラインパスに対応
* 0.6.0：削除が正しく行われないのを修正
* 0.5.0：新規作成

-----

### 検証バージョン

* Illustrator 2020（24.3）

-----

### ダウンロード

* [スクリプトをダウンロードする](https://github.com/gau/remove_needless_items/archive/master.zip)

-----

### インストール方法

1. ダウンロードしたファイルを解凍します。
2. 以下の場所に、「不要なアイテムを削除.jsx」をコピーします。Windows版ではお使いのIllustratorのモードによって保存する場所が異なりますのでご注意ください。
3. Illustratorを再起動します。
4. “ファイル”メニュー→“スクリプト”に“不要なアイテムを削除”と表示されていればインストール成功です。

#### ファイルをコピーする場所

| OS | バージョン | フォルダの場所 |
|:-----|:-----|:-----|
| Mac | 全 | /Applications/Adobe Illustrator *(ver)*/Presets/ja_JP/スクリプト/ |
| 32bit Win | CS5まで | C:\Program Files\Adobe\Adobe Illustrator *(ver)*\Presets\ja_JP\スクリプト\ |
| 64bit Win | CS5, CS6（32bit版） | C:\Program Files (x86)\Adobe\Adobe Illustrator *(ver)*\Presets\ja_JP\スクリプト\ |
| 64bit Win | CS6（64bit版）以降 | C:\Program Files\Adobe\Adobe Illustrator *(ver)* (64 Bit)\Presets\ja_JP\スクリプト\ |

* *(ver)*にはお使いのIllustratorのバージョンが入ります

-----

### 使い方

<div class="fig center"><img src="http://www.graphicartsunit.com/saucer/images/remove_needless_items/step1.png" alt="使い方" class="noshadow"></div>

1. スクリプトを実行します。
2. 削除したいオブジェクトの種類にチェックを入れます。
3. オプションを設定します。
4. ［実行］をクリックします。

-----

### 削除対象

削除できるオブジェクトは5種類です。それぞれは、以下のような基準で検出されます

| オブジェクト | 説明 |
|:-----------|:------------|
| 孤立点 | アンカーポイントが1つしかないオブジェクト |
| 空のポイント文字 | 文字がまったく入力されていないポイント文字。スペースも文字と見なします |
| 空のエリア内文字 | 文字がまったく入力されていないエリア内文字。スペースも文字と見なします |
| 空のパス上文字 | 文字がまったく入力されていないパス上文字。スペースも文字と見なします |
| 不透明度0％のオブジェクト | 不透明度が0％に設定されたオブジェクト。塗りのみ、線のみの不透明度は対象外です |
| ヘアラインパス | 線幅がなく、塗りだけの直線パス（詳しくは「 [ヘアラインパスについて](#aboutHairline) 」の項を参照）） |

-----

### ヘアラインパスの検出精度

ヘアラインパスは、各セグメントの角度から直線かどうかを判断します。直線とみなす角度の精度は、スクリプトの中の25行目あたりにある`HAIRLINE_ACCURACY`の値で変更できます。数を小さくするほどルーズになり、多少のゆがみがあってもヘアラインパスと判断します。シビアにしたいときはこの数を大きくしてください。初期値は`2000`です。

-----

### オプション

| オプション | 説明 |
|:-----------|:------------|
| 削除せずに選択する | 対象オブジェクトを選択した状態にします。いきなり削除したくないときや、確認だけしたいときに有効です |
| ロック、非表示オブジェクトも対象にする | ロック、非表示になっているオブジェクトも強制的に対象にします。ロック、非表示にされたレイヤー上のオブジェクトも対象となります |
| 実行後に報告メッセージを表示する | 実行したあとに、対象オブジェクトの数を報告します |

-----

### ロック、非表示オブジェクトも対象にする

［削除せずに選択する］と［ロック、非表示オブジェクトも対象にする］を両方選択したときは、対象オブジェクトとそれらが属するレイヤーのロック、非表示が強制的に解除されます。この組み合わせの際は、実行前に警告を表示します

-----

### ヘアラインパスについて

ヘアラインパスとは、線の設定がない塗りのみの直線パスで、印刷事故につながる要素のひとつです。本スクリプトでは、塗りのみの直線パスのうち、セグメントの角度がすべて同一のものをヘアラインパスとして検出します。また、2つ以上のアンカーポイントをもち、それらすべてが方向線を持たず同一座標で重なっているパスも、ヘアラインパスとして検出します。塗り、線ともに設定されていない透明のパスは検出しません。

-----

### その他

* シンボルやパターンなど、通常と異なる要素の中にあるオブジェクトや、複合シェイプに含まれているオブジェクトは、スクリプト側から取得できないため対象となりません。
* グループ化されている場合も、対象オブジェクトを個別に検出します。

-----

### 免責事項

* このスクリプトを使って起こったいかなる現象についても制作者は責任を負えません。すべて自己責任にてお使いください。
* データの構造などによっては、対象をブジェクトを取得できない可能性もゼロではありません。
* バージョン2020で動作の確認はしましたが、OSのバージョンやその他の状況によって実行できないことがあるかもしれません。もし動かなかったらごめんなさい。

-----

### ライセンス

* 不要オブジェクトを削除.jsx
* Copyright (c) 2020 Toshiyuki Takahashi
* Released under the MIT license
* [http://opensource.org/licenses/mit-license.php](http://opensource.org/licenses/mit-license.php)
* Created by Toshiyuki Takahashi ([Graphic Arts Unit](http://www.graphicartsunit.com/))
* [Twitter](https://twitter.com/gautt)